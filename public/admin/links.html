<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Shortlink Admin - Links</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="/favicon.ico">
  <link rel="stylesheet" href="/admin/admin.css?v=20260113">
  <style>
    .tabs { display:flex; gap:8px; border-bottom:1px solid var(--border); padding-bottom:10px; margin-bottom:16px; flex-wrap:wrap; }
    .tab-btn { border:1px solid var(--border); background:var(--panel); color:var(--text); padding:8px 14px; border-radius:999px; cursor:pointer; font-weight:600; }
    .tab-btn.active { border-color:var(--accent); color:var(--accent); }
    .tab-panel { display:none; }
    .tab-panel.active { display:block; }
  </style>
</head>
<body>
  <div class="admin-shell">
    <aside class="admin-side">
      <div class="brand">
        <span class="brand-badge">O</span>
        <span>OkLeaf</span>
      </div>
      <div class="side-meta">Admin workspace</div>
      <nav class="side-nav">
        <a href="/admin/dashboard.html">Dashboard</a>
        <a class="active" href="/admin/links.html">Links</a>
        <a href="/admin/domains.html">Domains</a>
        <a href="/admin/analytics.html">Analytics</a>
        <a href="/admin/audit.html">Audit</a>
        <a href="/admin/team.html">Team</a>
        <a href="/admin/api-keys.html">API Keys</a>
        <a href="/admin/site-settings.html">Site</a>
        <a href="/admin/billing.html">Billing</a>
        <a href="/admin/ecosystem.html">Ecosystem</a>
        <a href="/admin/affiliates.html">Affiliates</a>
        <a href="/admin/settings.html">Settings</a>
      </nav>
      <div class="side-footer">
        <button class="btn ghost" id="logoutBtn" type="button">Logout</button>
      </div>
    </aside>

    <div class="admin-main">
      <header class="admin-top">
        <div>
          <h1 class="page-title">Links</h1>
          <p class="page-sub">Create, manage, and share branded links.</p>
        </div>
      </header>

      <main class="admin-content">
        <div class="tabs" role="tablist" aria-label="Links sections">
          <button class="tab-btn active" type="button" data-tab="create" role="tab" aria-selected="true">Create</button>
          <button class="tab-btn" type="button" data-tab="manage" role="tab" aria-selected="false">Manage</button>
          <button class="tab-btn" type="button" data-tab="organize" role="tab" aria-selected="false">Tags &amp; Groups</button>
          <button class="tab-btn" type="button" data-tab="bulk" role="tab" aria-selected="false">Bulk</button>
        </div>

        <section class="tab-panel active" data-panel="create">
          <section class="card">
            <h3>Create a link</h3>
            <div class="grid">
              <label>
                Destination URL
                <input id="inUrl" class="input" type="url" placeholder="https://example.com/page" autocomplete="off">
              </label>
              <div class="card" id="utmWizardCard" style="grid-column: 1 / -1">
                <div class="row-between">
                  <div>
                    <h4 class="m-0">UTM builder</h4>
                    <div class="muted small">Build tracking parameters for this destination.</div>
                  </div>
                  <span class="pill" id="utmWizardBadge">Beginner mode</span>
                </div>
                <div class="wizard" id="utmWizard" data-step="1" style="margin-top:12px">
                  <div class="wizard-steps">
                    <button class="wizard-step" type="button" data-step="1">1. Source</button>
                    <button class="wizard-step" type="button" data-step="2">2. Campaign</button>
                    <button class="wizard-step" type="button" data-step="3">3. Preview</button>
                  </div>
                  <div class="wizard-panels">
                    <div class="wizard-panel" data-step="1">
                      <div class="grid grid-2">
                        <label>
                          UTM source
                          <input id="utmSource" class="input" type="text" placeholder="newsletter">
                        </label>
                        <label>
                          UTM medium
                          <input id="utmMedium" class="input" type="text" placeholder="email">
                        </label>
                      </div>
                    </div>
                    <div class="wizard-panel" data-step="2">
                      <div class="grid grid-2">
                        <label>
                          UTM campaign
                          <input id="utmCampaign" class="input" type="text" placeholder="launch">
                        </label>
                        <label>
                          UTM term
                          <input id="utmTerm" class="input" type="text" placeholder="keyword">
                        </label>
                      </div>
                      <label style="margin-top:12px">
                        UTM content
                        <input id="utmContent" class="input" type="text" placeholder="cta-variant">
                      </label>
                    </div>
                    <div class="wizard-panel" data-step="3">
                      <label class="muted">UTM preview</label>
                      <div class="muted" id="utmPreview">No UTM parameters.</div>
                      <div class="row" style="margin-top:8px">
                        <button class="btn ghost" id="utmApply">Apply to URL</button>
                        <button class="btn ghost" id="utmClear">Clear UTM</button>
                      </div>
                    </div>
                  </div>
                  <div class="wizard-actions">
                    <button id="utmWizardPrev" class="btn ghost wizard-nav" type="button">Back</button>
                    <button id="utmWizardNext" class="btn wizard-nav" type="button">Next</button>
                  </div>
                </div>
              </div>
              <div class="grid grid-2">
                <label>
                  Title (optional)
                  <input id="inTitle" class="input" type="text" placeholder="Campaign name" autocomplete="off">
                </label>
                <label>
                  Custom code (optional)
                  <input id="inCode" class="input" type="text" placeholder="letters, numbers, '-' '_'" autocomplete="off">
                </label>
              </div>
              <label>
                Domain
                <select id="inDomain" class="input"></select>
              </label>
              <label>
                Password (optional)
                <input id="inPassword" class="input" type="password" placeholder="Protect this link">
              </label>
              <div class="grid grid-2">
                <label>
                  Deep link URL (app)
                  <input id="inDeepLink" class="input" type="text" placeholder="myapp://path">
                </label>
                <label>
                  Deep link enabled
                  <select id="inDeepLinkEnabled" class="input">
                    <option value="auto" selected>Auto-enable</option>
                    <option value="true">Enabled</option>
                    <option value="false">Disabled</option>
                  </select>
                </label>
              </div>
              <div class="grid grid-2">
                <label>
                  iOS fallback URL
                  <input id="inIosFallback" class="input" type="url" placeholder="https://example.com/ios">
                </label>
                <label>
                  Android fallback URL
                  <input id="inAndroidFallback" class="input" type="url" placeholder="https://example.com/android">
                </label>
              </div>
              <div class="muted">Custom domains require a paid plan and verification.</div>
              <div class="grid grid-2">
                <label>
                  Tags
                  <select id="inTags" class="input" multiple size="4"></select>
                </label>
                <label>
                  Group
                  <select id="inGroup" class="input"></select>
                </label>
              </div>
              <div class="muted" id="codePreview">Short URL: https://okleaf.lnk/<span id="codePreviewValue">your-code</span></div>
              <div id="codeStatus" class="status muted">Enter a custom code to check availability.</div>
              <div class="row" style="justify-content:flex-end">
                <button id="btnCreate" class="btn">Create</button>
              </div>
              <div class="muted">Leave code blank to auto-generate.</div>
            </div>
          </section>
        </section>

        <section class="tab-panel" data-panel="manage">
          <section class="card">
            <h3>Your links</h3>
            <div class="row" style="gap:8px;margin-bottom:8px">
              <input id="inFilter" class="input" placeholder="Filter by title or code">
              <select id="filterTag" class="input" style="max-width:180px"></select>
              <select id="filterGroup" class="input" style="max-width:180px"></select>
              <button id="btnRefresh" class="btn ghost">Refresh</button>
              <button id="btnExport" class="btn ghost">Export CSV</button>
            </div>
            <div class="muted">Click table headers to sort. Copy grabs the short URL.</div>
          </section>

          <section class="card" style="margin-top:18px">
            <table id="tbl" aria-label="Links table">
              <thead>
                <tr>
                  <th data-sort="title">Title</th>
                  <th>Tags</th>
                  <th>Group</th>
                  <th data-sort="short_code">Code</th>
                  <th>Security</th>
                  <th>Domain</th>
                  <th>Short URL</th>
                  <th data-sort="click_count">Clicks</th>
                  <th data-sort="created_at">Created</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="rows">
                <tr><td class="empty" colspan="10">Loading...</td></tr>
              </tbody>
            </table>
          </section>
        </section>

        <section class="tab-panel" data-panel="organize">
          <div class="grid grid-2">
            <section class="card">
              <h3>Tags</h3>
              <div class="row" style="margin-bottom:10px">
                <input id="tagName" class="input" placeholder="New tag name">
                <input id="tagColor" class="input" placeholder="#84fab0 or brand color">
                <button id="tagAdd" class="btn">Add</button>
              </div>
              <div id="tagsList" class="grid"></div>
            </section>
            <section class="card">
              <h3>Groups</h3>
              <div class="row" style="margin-bottom:10px">
                <input id="groupName" class="input" placeholder="New group name">
                <input id="groupDesc" class="input" placeholder="Optional description">
                <button id="groupAdd" class="btn">Add</button>
              </div>
              <div id="groupsList" class="grid"></div>
            </section>
          </div>
        </section>

        <section class="tab-panel" data-panel="bulk">
          <div class="grid grid-2">
            <section class="card">
              <h3>Bulk create</h3>
              <div class="muted">Paste one URL per line. Optional title with comma: https://example.com, Campaign name</div>
              <textarea id="bulkUrls" class="input" rows="6" placeholder="https://example.com/page"></textarea>
              <div class="grid grid-2" style="margin-top:10px">
                <label>
                  Domain
                  <select id="bulkDomain" class="input"></select>
                </label>
                <label>
                  Password (optional)
                  <input id="bulkPassword" class="input" type="password" placeholder="Protect all">
                </label>
              </div>
              <div class="grid grid-2" style="margin-top:10px">
                <label>
                  CSV import
                  <input id="bulkCsv" class="input" type="file" accept=".csv,text/csv">
                </label>
                <label>
                  Import mode
                  <select id="bulkImportMode" class="input">
                    <option value="append" selected>Append</option>
                    <option value="replace">Replace list</option>
                  </select>
                </label>
              </div>
              <div class="muted small">CSV columns: url, title, short_code (optional).</div>
              <div class="grid grid-2" style="margin-top:10px">
                <label>
                  Tags
                  <select id="bulkTags" class="input" multiple size="4"></select>
                </label>
                <label>
                  Group
                  <select id="bulkGroup" class="input"></select>
                </label>
              </div>
              <div class="row" style="margin-top:12px;justify-content:flex-end">
                <button id="bulkCreateBtn" class="btn">Create links</button>
              </div>
              <div class="muted small" id="bulkCreateMsg"></div>
            </section>
            <section class="card">
              <h3>Bulk delete</h3>
              <div class="muted">Paste one short code per line.</div>
              <textarea id="bulkDeleteCodes" class="input" rows="6" placeholder="abcd1234"></textarea>
              <div class="row" style="margin-top:12px;justify-content:flex-end">
                <button id="bulkDeleteBtn" class="btn danger">Delete links</button>
              </div>
              <div class="muted small" id="bulkDeleteMsg"></div>
            </section>
          </div>
        </section>
      </main>
    </div>
  </div>

  <div class="modal" id="qrModal" aria-hidden="true">
    <div class="modal-backdrop" id="qrBackdrop"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="qrTitle">
      <div class="row" style="justify-content:space-between;align-items:center">
        <div>
          <div class="small muted" id="qrTitle">QR code</div>
        </div>
        <button class="btn ghost" id="qrClose" type="button">Close</button>
      </div>
      <div class="modal-body">
        <img id="qrImage" alt="QR code preview" />
      </div>
      <div class="row" style="justify-content:flex-end">
        <a class="btn ghost" id="qrDownload" download>Download</a>
      </div>
    </div>
  </div>

  <div class="modal" id="variantsModal" aria-hidden="true">
    <div class="modal-backdrop" id="variantsBackdrop"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="variantsTitle">
      <div class="row" style="justify-content:space-between;align-items:center">
        <div>
          <div class="small muted" id="variantsTitle">Variants</div>
        </div>
        <button class="btn ghost" id="variantsClose" type="button">Close</button>
      </div>
      <div class="modal-body">
        <div class="row" style="justify-content:space-between;align-items:center;margin-bottom:8px">
          <div class="muted small" id="variantsTotal">Total weight: 0</div>
          <button class="btn ghost" id="variantsNormalize" type="button">Normalize to 100%</button>
        </div>
        <div id="variantsList" class="grid" style="gap:10px"></div>
        <div class="row" style="margin-top:12px">
          <button class="btn ghost" id="variantAdd">Add variant</button>
          <span class="muted small" id="variantsMsg"></span>
        </div>
      </div>
      <div class="row" style="justify-content:flex-end">
        <button class="btn" id="variantsSave">Save variants</button>
      </div>
    </div>
  </div>

  <div class="modal" id="routesModal" aria-hidden="true">
    <div class="modal-backdrop" id="routesBackdrop"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="routesTitle">
      <div class="row" style="justify-content:space-between;align-items:center">
        <div>
          <div class="small muted" id="routesTitle">Routing rules</div>
        </div>
        <button class="btn ghost" id="routesClose" type="button">Close</button>
      </div>
      <div class="modal-body">
        <div class="muted small" style="margin-bottom:10px">
          First match wins. Country uses ISO codes (US, GB). Device values: mobile, tablet, desktop. Platform: ios, android.
        </div>
        <div id="routesList" class="grid" style="gap:12px"></div>
        <div class="row" style="margin-top:12px">
          <button class="btn ghost" id="routeAdd" type="button">Add rule</button>
          <span class="muted small" id="routesMsg"></span>
        </div>
      </div>
      <div class="row" style="justify-content:flex-end">
        <button class="btn" id="routesSave">Save rules</button>
      </div>
    </div>
  </div>

  <div class="modal" id="passwordModal" aria-hidden="true">
    <div class="modal-backdrop" id="passwordBackdrop"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="passwordTitle">
      <div class="row" style="justify-content:space-between;align-items:center">
        <div>
          <div class="small muted" id="passwordTitle">Password protection</div>
        </div>
        <button class="btn ghost" id="passwordClose" type="button">Close</button>
      </div>
      <div class="modal-body">
        <label class="muted">New password</label>
        <input id="passwordValue" class="input" type="password" placeholder="At least 6 characters">
        <div class="muted small" id="passwordMsg" style="margin-top:8px"></div>
      </div>
      <div class="row" style="justify-content:flex-end;gap:8px">
        <button class="btn ghost" id="passwordClear" type="button">Clear protection</button>
        <button class="btn" id="passwordSave" type="button">Save password</button>
      </div>
    </div>
  </div>

  <script type="module" src="/admin/links.js"></script>
</body>
</html>
